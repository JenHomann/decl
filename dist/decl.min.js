!function t(e,n,i){function o(s,c){if(!n[s]){if(!e[s]){var a="function"==typeof require&&require;if(!c&&a)return a(s,!0);if(r)return r(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){var n=e[s][1][t];return o(n?n:t)},h,h.exports,t,e,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){"use strict";var i=t("./scope");Object.defineProperty(n,"__esModule",{value:!0}),n.default=o;var o=function(){function t(t){this.scope=i.Scope.buildRootScope(t)}return t.getDefaultInstance=function(){return this.defaultInstance||(this.defaultInstance=new t(document.documentElement))},t.setDefaultInstance=function(t){return this.defaultInstance=t},t.select=function(t,e){return this.getDefaultInstance().select(t,e)},t.when=function(t,e){return this.getDefaultInstance().when(t,e)},t.on=function(t,e){return this.getDefaultInstance().on(t,e)},t.prototype.getScope=function(){return this.scope},t.prototype.select=function(t,e){return this.scope.select(t,e)},t.prototype.when=function(t,e){return this.scope.when(t,e)},t.prototype.on=function(t,e){return this.scope.on(t,e)},t}();n.Decl=o,"undefined"!=typeof window&&(window.Decl=o)},{"./scope":3}],2:[function(t,e,n){"use strict";function i(t){return"object"==typeof t&&"number"==typeof t.length}function o(t){if(i(t))return Array.prototype.slice.call(t,0);throw new TypeError("Expected ArrayLike")}function r(t,e){return Array.prototype.indexOf.call(t,e)!==-1}Object.defineProperty(n,"__esModule",{value:!0}),n.default=s;var s=function(){function t(){}return t.isMatchingElement=function(t,e){return this.getInstance().isMatchingElement(t,e)},t.collectMatchingElements=function(t,e){return this.getInstance().collectMatchingElements(t,e)},t.getInstance=function(){return this.instance||(this.instance=new t)},t.prototype.isMatchingElement=function(e,n){switch(typeof n){default:throw new TypeError(t.ELEMENT_MATCHER_TYPE_ERROR_MESSAGE);case"string":var i=n;return this.isMatchingElementFromCssSelector(e,i);case"object":var o=n;return this.isMatchingElementFromObject(e,o);case"function":var r=n;return this.isMatchingElementFromElementVistor(e,r)}},t.prototype.collectMatchingElements=function(e,n){switch(typeof n){default:throw new TypeError(t.ELEMENT_MATCHER_TYPE_ERROR_MESSAGE);case"string":var i=n;return this.collectMatchingElementsFromCssSelector(e,i);case"object":var o=n;return this.collectMatchingElementsFromObject(e,o);case"function":var r=n;return this.collectMatchingElementsFromElementVistor(e,r)}},t.prototype.isMatchingElementFromCssSelector=function(t,e){return"function"==typeof t.matches?t.matches(e):r(document.querySelectorAll(e),t)},t.prototype.isMatchingElementFromObject=function(e,n){if(null===n)return!1;if(i(n)){var o=n;if(0===o.length||o[0]instanceof Element)return r(o,e);throw new TypeError(t.ELEMENT_MATCHER_TYPE_ERROR_MESSAGE)}throw new TypeError(t.ELEMENT_MATCHER_TYPE_ERROR_MESSAGE)},t.prototype.isMatchingElementFromElementVistor=function(t,e){var n=e(t);if("boolean"==typeof n){var i=n;return i}var o=n;return this.isMatchingElement(t,o)},t.prototype.collectMatchingElementsFromCssSelector=function(t,e){return o(t.querySelectorAll(e))},t.prototype.collectMatchingElementsFromObject=function(e,n){if(null===n)return[];if(i(n)){var r=n;if(0===r.length||r[0]instanceof Element)return o(r);throw new TypeError(t.ELEMENT_MATCHER_TYPE_ERROR_MESSAGE)}throw new TypeError(t.ELEMENT_MATCHER_TYPE_ERROR_MESSAGE)},t.prototype.collectMatchingElementsFromElementVistor=function(t,e){for(var n=[],i=0,o=t.children;i<o.length;i++){var r=o[i];if(r instanceof Element){var s=r,c=e(s);if("boolean"==typeof c){var a=c;a&&n.push(s)}else n.push.apply(n,this.collectMatchingElements(s,c))}}return n},t}();s.ELEMENT_MATCHER_TYPE_ERROR_MESSAGE="Decl: An `ElementMatcher` must be a CSS selector (string) or a function which takes a node under consideration and returns a CSS selector (string) that matches all matching nodes in the subtree, an array-like object of matching nodes in the subtree, or a boolean value as to whether the node should be included (in this case, the function will be invoked again for all children of the node).",n.ElementCollector=s},{}],3:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=o;var i=t("./subscriptions"),o=function(){function t(t,e){this.isActivated=!1,this.subscriptions=[],this.children=[],this.element=t,e&&e.call(this,this)}return t.buildRootScope=function(e){var n=new t(e);return n.activate(),n},t.prototype.getElement=function(){return this.element},t.prototype.match=function(t){return this.addSubscription(new i.TrivialSubscription(this.element,{connected:!0},t)),this},t.prototype.unmatch=function(t){return this.addSubscription(new i.TrivialSubscription(this.element,{disconnected:!0},t)),this},t.prototype.select=function(t,e){return this.addSubscription(new i.MatchingElementsSubscription(this.element,t,this.buildSelectExecutor(e))),this},t.prototype.when=function(t,e){return this.addSubscription(new i.ElementMatchesSubscription(this.element,t,this.buildWhenExecutor(e))),this},t.prototype.on=function(t,e){return this.addSubscription(new i.EventSubscription(this.element,t,e)),this},t.prototype.activate=function(){if(!this.isActivated){this.isActivated=!0;for(var t=0,e=this.subscriptions;t<e.length;t++){var n=e[t];n.connect()}}},t.prototype.deactivate=function(){if(this.isActivated){for(var t=0,e=this.subscriptions;t<e.length;t++){var n=e[t];n.disconnect()}this.isActivated=!1}},t.prototype.addSubscription=function(t){this.subscriptions.push(t),this.isActivated&&t.connect()},t.prototype.buildSelectExecutor=function(e){var n=[];return function(i,o){for(var r=0,s=o.addedElements;r<s.length;r++){var c=s[r],a=new t(c,e);n.push(a),a.activate()}for(var u=0,h=o.removedElements;u<h.length;u++)for(var l=h[u],p=0,f=n.length,a=void 0;p<f;p++)if(a=n[p],a.element===l){a.deactivate(),n.splice(p,1);break}}},t.prototype.buildWhenExecutor=function(e){var n=this,i=null;return function(o,r){r.isMatching?(i=new t(n.element,e),i.activate()):(i.deactivate(),i=null)}},t}();n.Scope=o},{"./subscriptions":4}],4:[function(t,e,n){"use strict";function i(t,e){for(var n=[],i=0,o=t;i<o.length;i++){var r=o[i];e.indexOf(r)===-1&&n.push(r)}return n}var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=t("./element_collector");Object.defineProperty(n,"__esModule",{value:!0}),n.default={Subscription:s,TrivialSubscription:c,EventSubscription:a,MatchingElementsSubscription:p,ElementMatchesSubscription:m};var s=function(){function t(t,e){this.element=t,this.executor=e}return t}();n.Subscription=s;var c=function(t){function e(e,n,i){var o=t.call(this,e,i)||this;return o.config=n,o}return o(e,t),e.prototype.connect=function(){this.isConnected||(this.isConnected=!0,this.config.connected&&this.executor(this.element))},e.prototype.disconnect=function(){this.isConnected&&(this.isConnected=!1,this.config.disconnected&&this.executor(this.element))},e}(s);n.TrivialSubscription=c;var a=function(t){function e(e,n,i){var o=t.call(this,e,i)||this;return o.isConnected=!1,o.eventMatcher=n,o.eventNames=o.parseEventMatcher(o.eventMatcher),o.eventListener=function(t){o.handleEvent(t)},o}return o(e,t),e.prototype.connect=function(){if(!this.isConnected){this.isConnected=!0;for(var t=0,e=this.eventNames;t<e.length;t++){var n=e[t];this.element.addEventListener(n,this.eventListener,!1)}}},e.prototype.disconnect=function(){if(this.isConnected){for(var t=0,e=this.eventNames;t<e.length;t++){var n=e[t];this.element.removeEventListener(n,this.eventListener,!1)}this.isConnected=!1}},e.prototype.handleEvent=function(t){this.executor(this.element,t)},e.prototype.parseEventMatcher=function(t){return t.split(" ")},e}(s);n.EventSubscription=a;var u=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.isListening=!1,i.handleMutationTimeout=null,i.mutationCallback=function(){i.deferHandleMutations()},i.mutationObserver=new MutationObserver(i.mutationCallback),i}return o(e,t),e.prototype.startListening=function(){this.isListening||(this.mutationObserver.observe(this.element,e.mutationObserverInit),this.isListening=!0)},e.prototype.stopListening=function(){this.isListening&&(this.mutationObserver.disconnect(),this.handleMutationsNow(),this.isListening=!1)},e.prototype.deferHandleMutations=function(){var t=this;null===this.handleMutationTimeout&&(this.handleMutationTimeout=setTimeout(function(){try{t.mutationObserver.takeRecords(),t.handleMutations()}finally{t.handleMutationTimeout=null}},0))},e.prototype.handleMutationsNow=function(){null!==this.handleMutationTimeout&&(clearTimeout(this.handleMutationTimeout),this.handleMutationTimeout=null,this.handleMutations())},e}(s);u.mutationObserverInit={childList:!0,attributes:!0,characterData:!0,subtree:!0};var h=function(){function t(t){this.name=t}return t}();n.DeclEvent=h;var l=function(t){function e(e,n,i){var o=t.call(this,"MatchingElementsChanged")||this;return o.matchingElementsSubscription=e,o.addedElements=n,o.removedElements=i,o}return o(e,t),e}(h);n.MatchingElementsChangedEvent=l;var p=function(t){function e(e,n,i){var o=t.call(this,e,i)||this;return o.matchingElements=[],o.matcher=n,o}return o(e,t),e.prototype.connect=function(){this.isConnected||(this.updateMatchingElements(this.collectMatchingElements()),this.startListening(),this.isConnected=!0)},e.prototype.disconnect=function(){this.isConnected&&(this.updateMatchingElements([]),this.stopListening(),this.isConnected=!1)},e.prototype.handleMutations=function(){this.updateMatchingElements(this.collectMatchingElements())},e.prototype.updateMatchingElements=function(t){var e=this.matchingElements,n=i(t,e),o=i(e,t);if(this.matchingElements=t,n.length>0||o.length>0){var r=new l(this,n,o);this.executor(this.element,r)}},e.prototype.collectMatchingElements=function(){return r.ElementCollector.collectMatchingElements(this.element,this.matcher)},e}(u);n.MatchingElementsSubscription=p;var f=function(t){function e(e,n){var i=t.call(this,"ElementMatchsChangedEvent")||this;return i.elementMatchesSubscription=e,i.isMatching=n,i}return o(e,t),e}(h);n.ElementMatchsChangedEvent=f;var m=function(t){function e(e,n,i){var o=t.call(this,e,i)||this;return o.matcher=n,o}return o(e,t),e.prototype.connect=function(){this.isConnected||(this.updateIsMatchingElement(this.computeIsMatchingElement()),this.startListening(),this.isConnected=!0)},e.prototype.disconnect=function(){this.isConnected&&(this.updateIsMatchingElement(!1),this.stopListening(),this.isConnected=!1)},e.prototype.handleMutations=function(){this.updateIsMatchingElement(this.computeIsMatchingElement())},e.prototype.updateIsMatchingElement=function(t){var e=this.isMatchingElement;if(this.isMatchingElement=e,e!==t){var n=new f(this,t);this.executor(this.element,n)}},e.prototype.computeIsMatchingElement=function(){return r.ElementCollector.isMatchingElement(this.element,this.matcher)},e}(u);n.ElementMatchesSubscription=m},{"./element_collector":2}]},{},[1]);
//# sourceMappingURL=decl.min.js.map
